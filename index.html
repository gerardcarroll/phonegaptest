<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">

<title>SelecTunes</title>

<link rel="stylesheet" href="jquery-mobile-1.3.2.css" />
<link rel="stylesheet" href="custom.css" />
<script src="jquery-1.9.1.js"></script>
<script src="jquery-mobile-1.3.2.js"></script>

<meta name="viewport" content="height=device-height, width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, usr-scalable=no">

 
</head> 


<body> 
<!--Splash Screen-->
	<div data-role="page" id="splash">
		<div class="splash">
			<!--<img src="images/recordlogo.png"/>-->
		</div>
   	</div>

<!--First Page-->
    <div data-role="page" id="page">
        <div data-role="header" data-position="fixed" >
            <h1>Playlist</h1>            
        </div>
        
        
       	<div class="ui-grid-b">
            	<div class="ui-block-a"><!--<div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="null" data-iconpos="null" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-submit ui-btn-up-c" aria-disabled="false"><!--<span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Artists</span></span>--><button type="submit" data-theme="c" class="ui-btn-hidden" aria-disabled="false">All Tracks</button></div><!--</div>-->
            
                <div class="ui-block-b"><!--<div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="null" data-iconpos="null" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-submit ui-btn-up-c" aria-disabled="false"><!--<span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Artists</span></span>--><button type="submit" data-theme="c" class="ui-btn-hidden" aria-disabled="false">Artists</button></div><!--</div>-->
                
                <div class="ui-block-c"><!--<div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="null" data-iconpos="null" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-submit ui-btn-up-c" aria-disabled="false"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Albums</span></span>--><button type="submit" data-theme="c" class="ui-btn-hidden" aria-disabled="false">Albums</button></div><!--</div>-->
                
                <!--<div class="ui-block-d"><!--<div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="null" data-iconpos="null" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-submit ui-btn-up-c" aria-disabled="false"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Genre</span></span><button type="submit" data-theme="c" class="ui-btn-hidden" aria-disabled="false">Genre</button></div></div>-->
                
                <!--<div class="ui-block-e">--><!--<div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="null" data-iconpos="null" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-submit ui-btn-up-c" aria-disabled="false"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Top 20</span></span>--><!--<button type="submit" data-theme="c" class="ui-btn-hidden" aria-disabled="false">Top 20</button></div>--><!--</div>-->
       	</div>
        
        
        <div data-role="content">
            <ul id="listview" data-role="listview" data-filter="true">                
            </ul>		
        </div>        		
        
        <div data-role="popup" id="positionWindow"><p><strong>Track Will Play Shortly</strong></p></div>    
        
        <div data-role="footer" data-id="myfooter" >
            <h4>&copy; SelecTunes</h4>
        </div>
    </div>
    
<!--Second Page-->    
    <div data-role="page" id="page2">
        <div data-role="header">
            <h1>Filter Playlist</h1>
        </div>
        <div data-role="content">	
            <ul id="filter" data-role="listview">
            <li id="album"><a>Album</a></li>
            <li id="artist"><a>Artist</a></li>
            <li id="genre"><a>Genre</a></li>
            </ul>	
        </div>
        <div data-role="footer">
            <h4>Page Footer</h4>
        </div>
    </div>
    
<!--Third Page-->    
    <div data-role="page" id="page3">
        <div data-role="header">
            <h1>Genre's</h1>
        </div>
        <div data-role="content">	
            <ul id="genreview" data-role="listview" data-filter="true">
                
            </ul>		
        </div>
        <div data-role="footer">
            <h4>Page Footer</h4>
        </div>
    </div>

<!--Fourth Page-->    
    <div data-role="page" id="page4">
        <div data-role="header">
            <h1>Page Four</h1>
        </div>
        <div data-role="content">	
            Content		
        </div>
        <div data-role="footer">
            <h4>Page Footer</h4>
        </div>
    </div>


</body>

<script type="text/javascript">


//var apiUrl = 'http://selectunes-test.azurewebsites.net/api/tracks';
var apiUrl = 'http://localhost:51887/api/Tracks';
var value = 0;

$(document).ready(function() {
	
	$(function(){
		setTimeout(hideSplash,1500);
	});
	
	function hideSplash(){
		$.mobile.changePage("#page", "fade");
	}
	
	//$("#positionWindow").hide();
	
	$(function(){
		setTimeout(getPlaylist,2000);
	});
	
	function getPlaylist(){
		$.mobile.loading( 'show', {
			text: 'Loading Playlist',
			textVisible: true,
			theme: 'a',
			html: ""
		});
		
		//$.mobile.showPageLoadingMsg("a","Loading Playlist");
		$.support.cors = true;
		var a = "a";
		$.getJSON(apiUrl)
            .done(function (data) {
				$.each(data, function (index, track) {
					trac = {Id : track.Id, Name : track.Name}
                    $('<li id=' + trac.Id + '><a id=' + trac.Id + a + '>' + trac.Name + '</a></li>').appendTo($('#listview'));										
					$.mobile.hidePageLoadingMsg();
					$('#listview').listview('refresh');								
                });    				          
			});
	}
			
		//When a track is selected	
		$("#listview").on('click', 'li', function() {
            
		
		track = {
			Id: $(this).attr('id'),
			Name: $(this).text()       
			    
        };
		
			var x = track.Id;
			var aID = '' + x + 'a';
			
		$('#listview').listview('refresh');
		
		$.support.cors = true;       
        //Post the track id to API
        $.ajax({
            url: 'http://localhost:51887/api/selecttracks/',
            type: 'POST',
            data: JSON.stringify('='+track.Id.toString()), 
			dataType:"json",
            contentType: "application/json;charset=utf-8",
            success: function (data) {
				//var z = $(aID).attr('href');
				//alert(z);
				//$("#aID").attr("href", "#positionWindow");
				//$("#aID").click();
				
				//alert(aID);
				
				//$(document).click();
				alert("Your Track will play Shortly");
            },
            error: function (data, err) {
				alert("Failed");
            },
			
        });	
			
	});
	
	//Get filters eg by genre,artist,album

//When genre is selected	

		$("#filter").on('click', 'li', function() {
		
		$.mobile.changePage("#page3", "fade");
		
		var genreUrl = 'http://localhost:51887/api/genre/';
		
		//function getGenrelist(){
		/*$(function(){
			setTimeout(getGenrelist,1000);
		});*/
	
		/*function getGenrelist(){
			$.mobile.loading( 'show', {
				text: 'Loading Genre List',
				textVisible: true,
				theme: 'a',
				html: ""
			});*/
			
		
		$.support.cors = true;
		
		$.getJSON(genreUrl)
            .done(function (data) {
				alert(data);
				$.each(data, function (index, genre) {
					gen = {Id : genre.Id, Name : genre.Name};
					
                    //$('<li id=' + gen.Id + '><a>' + gen.Name + '</a></li>').appendTo($('#genreview'));										
					//$.mobile.hidePageLoadingMsg();
					
					//$('#genreview').listview('refresh');								
                });    				          
			});
		//}
		});
		
			
});

    
</script>
</html>
