<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">
<title>SelecTunes</title>

<link rel="stylesheet" href="jquery-mobile-1.3.2.css" />
<link rel="stylesheet" href="custom.css" />
<script src="jquery-1.9.1.js"></script>
<script src="jquery-mobile-1.3.2.js"></script>

<meta name="viewport" content="height=device-height, width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, usr-scalable=no">

@media screen and (orientation: portrait) {
 @-ms-viewport {
    width: 320px;
    user-zoom: fixed;
    max-zoom: 1;
    min-zoom: 1;
 }
}
 
</head> 
<script type="text/javascript">


var apiUrl = 'http://selectunes-test.azurewebsites.net/api/tracks';
//var apiUrl = 'http://localhost:51887/api/Tracks';
var value = 0;

$(document).ready(function() {
	
	$(function(){
		setTimeout(hideSplash,2500);
	});
	
	function hideSplash(){
		$.mobile.changePage("#page", "fade");
	}
	
	$(function(){
		setTimeout(getPlaylist,3000);
	});
	
	function getPlaylist(){
		$.mobile.loading( 'show', {
			text: 'Loading Playlist',
			textVisible: true,
			theme: 'a',
			html: ""
		});
		
		//$.mobile.showPageLoadingMsg("a","Loading Playlist");
		jQuery.support.cors = true;
	
		$.getJSON(apiUrl)
            .done(function (data) {
				$.each(data, function (index, track) {
					trac = {Id : track.Id, Name : track.Name}
                    $('<li id=' + trac.Id + '><a href="#">' + trac.Name + '</a></li>').appendTo($('#listview'));										
					$.mobile.hidePageLoadingMsg();
					$('#listview').listview('refresh');								
                });    				          
			});
	}
			
		//When a track is selected	
		$("#listview").on('click', 'li', function() {
            		
		track = {
			Id: $(this).attr('id'),
			Name: $(this).text()           
        };
		
		jQuery.support.cors = true;       
        //Post the track id to API
        $.ajax({
            url: 'http://selectunes-test.azurewebsites.net/api/selecttracks/',
            type: 'POST',
            data: JSON.stringify('='+track.Id.toString()), 
			dataType:"json",
            contentType: "application/json;charset=utf-8",
            success: function (data) {
				alert("Your Track will play Shortly");
            },
            error: function (data, err) {
				alert("Failed");
            },
			
        });	
			
	});
});
    
</script>

<body> 
<!--Splash Screen-->
	<div data-role="page" class="fullScreenDiv" id="splash">
		<div class="splash">
			<h1>SelecTunes</h1>
		</div>
   	</div>

<!--First Page-->
    <div data-role="page" id="page">
        <div data-role="header" data-position="fixed" >
            <h1>Playlist</h1>
        </div>
        <div data-role="content">
            <ul id="listview" data-role="listview">
                
            </ul>		
        </div>
        <div data-role="footer" data-id="myfooter" data-position="fixed" >
            <h4>&copy; SelecTunes</h4>
        </div>
    </div>
    
<!--Second Page-->    
    <div data-role="page" id="page2">
        <div data-role="header">
            <h1>Page Two</h1>
        </div>
        <div data-role="content">	
            Content		
        </div>
        <div data-role="footer">
            <h4>Page Footer</h4>
        </div>
    </div>
    
<!--Third Page-->    
    <div data-role="page" id="page3">
        <div data-role="header">
            <h1>Page Three</h1>
        </div>
        <div data-role="content">	
            Content		
        </div>
        <div data-role="footer">
            <h4>Page Footer</h4>
        </div>
    </div>

<!--Fourth Page-->    
    <div data-role="page" id="page4">
        <div data-role="header">
            <h1>Page Four</h1>
        </div>
        <div data-role="content">	
            Content		
        </div>
        <div data-role="footer">
            <h4>Page Footer</h4>
        </div>
    </div>


</body>
</html>
